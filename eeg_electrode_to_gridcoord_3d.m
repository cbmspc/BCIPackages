function [XYZCoords, ChanNames, FlatXYCoords] = eeg_electrode_to_gridcoord_3d (ChanNames)
% 10-5 placement standard
% Based on CSDtoolbox
% http://psychophysiology.cpmc.columbia.edu/software/CSDtoolbox/tutorial.html
% 
% Put 'all' in ChanNames to return everything

[ElecNames, ElecCoords_cart, ElecCoords_sph] = populate_coords();
ElecCoords_flatcart = flatten(ElecCoords_cart, ElecCoords_sph);

if ischar(ChanNames) && strcmp(ChanNames, 'all')
    XYZCoords = ElecCoords_cart;
    FlatXYCoords = ElecCoords_flatcart;
    ChanNames = ElecNames;
    return
end

if ~iscell(ChanNames) && ischar(ChanNames)
    ChanNames = string_to_cell(ChanNames, ', ');
end
XYZCoords = nan(length(ChanNames),3);
FlatXYCoords = nan(length(ChanNames),2);

cid = chan2idx(ElecNames, ChanNames);

for i = 1:length(cid)
    if cid(i)
        XYZCoords(i,:) = ElecCoords_cart(cid(i),:);
        FlatXYCoords(i,:) = ElecCoords_flatcart(cid(i),:);
    end
end



function ElecCoords_flatcart = flatten (ElecCoords_cart, ElecCoords_sph)
theta = ElecCoords_sph(:,1)/180*pi;
phi = ElecCoords_sph(:,2)/180*pi;
ElecCoords_cart2 = ElecCoords_cart;
ElecCoords_cart2(:,3) = ElecCoords_cart2(:,3) - 1;

phi_2 = phi(12);
theta_2 = theta(12);

for i = length(phi):-1:1
    arclen_from_Cz(i) = greatcircledistance(theta(i), phi(i), theta_2, phi_2, 1);
end
angle_from_Cz = atan2( ElecCoords_cart2(:,2), ElecCoords_cart2(:,1) );
ElecCoords_flatcart = [arclen_from_Cz(:) .* cos(angle_from_Cz(:)), arclen_from_Cz(:) .* sin(angle_from_Cz(:))];



function arclen = greatcircledistance (theta_1, phi_1, theta_2, phi_2, radius)
% From http://math.stackexchange.com/questions/231221/great-arc-distance-between-two-points-on-a-unit-sphere
[x,y,z] = sph2cart(theta_1, phi_1, radius);
xyz_1 = [x,y,z];
[x,y,z] = sph2cart(theta_2, phi_2, radius);
xyz_2 = [x,y,z];
aa = cross(xyz_1, xyz_2);
bb = dot(xyz_1', xyz_2');
aa = arrayfun(@(n) norm(aa(n, :)), 1:size(aa, 1));
arclen = radius * atan2(aa, bb)';





function [ElecNames, ElecCoords_cart, ElecCoords_sph] = populate_coords ()
ElecNames = string_to_cell('Nose Nz NFpz Fpz AFpz AFz AFFz Fz FFCz FCz FCCz Cz CCPz CPz CPPz Pz PPOz POz POOz Oz OIz Iz N1h N1 AFp9 AF9 AFF9 F9 FFT9 FT9 FTT9 T9 TTP9 TP9 TPP9 P9 PPO9 PO9 POO9 I1 I1h NFp1h NFp1 AFp9h AF9h AFF9h F9h FFT9h FT9h FTT9h T9h TTP9h TP9h TPP9h P9h PPO9h PO9h POO9h OI1 OI1h Fp1h Fp1 AFp7 AF7 AFF7 F7 FFT7 FT7 FTT7 T7 TTP7 TP7 TPP7 P7 PPO7 PO7 POO7 O1 O1h N2h N2 AFp10 AF10 AFF10 F10 FFT10 FT10 FTT10 T10 TTP10 TP10 TPP10 P10 PPO10 PO10 POO10 I2 I2h NFp2h NFp2 AFp10h AF10h AFF10h F10h FFT10h FT10h FTT10h T10h TTP10h TP10h TPP10h P10h PPO10h PO10h POO10h OI2 OI2h Fp2h Fp2 AFp8 AF8 AFF8 F8 FFT8 FT8 FTT8 T8 TTP8 TP8 TPP8 P8 PPO8 PO8 POO8 O2 O2h T7h C5 C5h C3 C3h C1 C1h T8h C6 C6h C4 C4h C2 C2h F3 F4 P3 P4 F5 F6 P5 P6 F1 F2 P1 P2 F7h F8h P7h P8h F5h F6h P5h P6h F3h F4h P3h P4h F1h F2h P1h P2h FC3 FC4 CP3 CP4 FC5 FC6 CP5 CP6 FC1 FC2 CP1 CP2 FT7h FT8h TP7h TP8h FC5h FC6h CP5h CP6h FC3h FC4h CP3h CP4h FC1h FC2h CP1h CP2h AF3 AF4 PO3 PO4 AF5 AF6 PO5 PO6 AF1 AF2 PO1 PO2 AF7h AF8h PO7h PO8h AF5h AF6h PO5h PO6h AF3h AF4h PO3h PO4h AF1h AF2h PO1h PO2h AFp3 AFp4 POO3 POO4 AFp5 AFp6 POO5 POO6 AFp1 AFp2 POO1 POO2 AFF3 AFF4 PPO3 PPO4 AFF5 AFF6 PPO5 PPO6 AFF1 AFF2 PPO1 PPO2 AFF7h AFF8h PPO7h PPO8h AFF5h AFF6h PPO5h PPO6h AFF3h AFF4h PPO3h PPO4h AFF1h AFF2h PPO1h PPO2h FFC3 FFC4 CPP3 CPP4 FFC5 FFC6 CPP5 CPP6 FFC1 FFC2 CPP1 CPP2 FFT7h FFT8h TPP7h TPP8h FFC5h FFC6h CPP5h CPP6h FFC3h FFC4h CPP3h CPP4h FFC1h FFC2h CPP1h CPP2h FCC3 FCC4 CCP3 CCP4 FCC5 FCC6 CCP5 CCP6 FCC1 FCC2 CCP1 CCP2 FTT7h FTT8h TTP7h TTP8h FCC5h FCC6h CCP5h CCP6h FCC3h FCC4h CCP3h CCP4h FCC1h FCC2h CCP1h CCP2h A1 A2 LPA RPA LM RM 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129', ' ');

ElecCoords_cart = [
         0    0.8315   -0.5556
         0    0.9239   -0.3827
         0    0.9808   -0.1951
         0    1.0000         0
         0    0.9808    0.1951
         0    0.9239    0.3827
         0    0.8315    0.5556
         0    0.7071    0.7071
         0    0.5556    0.8315
         0    0.3827    0.9239
         0    0.1951    0.9808
         0         0    1.0000
         0   -0.1951    0.9808
         0   -0.3827    0.9239
         0   -0.5556    0.8315
         0   -0.7071    0.7071
         0   -0.8315    0.5556
         0   -0.9239    0.3827
         0   -0.9808    0.1951
         0   -1.0000         0
         0   -0.9808   -0.1951
         0   -0.9239   -0.3827
   -0.1445    0.9125   -0.3827
   -0.2855    0.8787   -0.3827
   -0.4194    0.8232   -0.3827
   -0.5430    0.7474   -0.3827
   -0.6533    0.6533   -0.3827
   -0.7474    0.5430   -0.3827
   -0.8232    0.4194   -0.3827
   -0.8787    0.2855   -0.3827
   -0.9125    0.1445   -0.3827
   -0.9239         0   -0.3827
   -0.9125   -0.1445   -0.3827
   -0.8787   -0.2855   -0.3827
   -0.8232   -0.4194   -0.3827
   -0.7474   -0.5430   -0.3827
   -0.6533   -0.6533   -0.3827
   -0.5430   -0.7474   -0.3827
   -0.4194   -0.8232   -0.3827
   -0.2855   -0.8787   -0.3827
   -0.1445   -0.9125   -0.3827
   -0.1534    0.9687   -0.1951
   -0.3031    0.9328   -0.1951
   -0.4453    0.8739   -0.1951
   -0.5765    0.7935   -0.1951
   -0.6935    0.6935   -0.1951
   -0.7935    0.5765   -0.1951
   -0.8739    0.4453   -0.1951
   -0.9328    0.3031   -0.1951
   -0.9687    0.1534   -0.1951
   -0.9808         0   -0.1951
   -0.9687   -0.1534   -0.1951
   -0.9328   -0.3031   -0.1951
   -0.8739   -0.4453   -0.1951
   -0.7935   -0.5765   -0.1951
   -0.6935   -0.6935   -0.1951
   -0.5765   -0.7935   -0.1951
   -0.4453   -0.8739   -0.1951
   -0.3031   -0.9328   -0.1951
   -0.1534   -0.9687   -0.1951
   -0.1564    0.9877         0
   -0.3090    0.9511         0
   -0.4540    0.8910         0
   -0.5878    0.8090         0
   -0.7071    0.7071         0
   -0.8090    0.5878         0
   -0.8910    0.4540         0
   -0.9511    0.3090         0
   -0.9877    0.1564         0
   -1.0000         0         0
   -0.9877   -0.1564         0
   -0.9511   -0.3090         0
   -0.8910   -0.4540         0
   -0.8090   -0.5878         0
   -0.7071   -0.7071         0
   -0.5878   -0.8090         0
   -0.4540   -0.8910         0
   -0.3090   -0.9511         0
   -0.1564   -0.9877         0
    0.1445    0.9125   -0.3827
    0.2855    0.8787   -0.3827
    0.4194    0.8232   -0.3827
    0.5430    0.7474   -0.3827
    0.6533    0.6533   -0.3827
    0.7474    0.5430   -0.3827
    0.8232    0.4194   -0.3827
    0.8787    0.2855   -0.3827
    0.9125    0.1445   -0.3827
    0.9239         0   -0.3827
    0.9125   -0.1445   -0.3827
    0.8787   -0.2855   -0.3827
    0.8232   -0.4194   -0.3827
    0.7474   -0.5430   -0.3827
    0.6533   -0.6533   -0.3827
    0.5430   -0.7474   -0.3827
    0.4194   -0.8232   -0.3827
    0.2855   -0.8787   -0.3827
    0.1445   -0.9125   -0.3827
    0.1534    0.9687   -0.1951
    0.3031    0.9328   -0.1951
    0.4453    0.8739   -0.1951
    0.5765    0.7935   -0.1951
    0.6935    0.6935   -0.1951
    0.7935    0.5765   -0.1951
    0.8739    0.4453   -0.1951
    0.9328    0.3031   -0.1951
    0.9687    0.1534   -0.1951
    0.9808         0   -0.1951
    0.9687   -0.1534   -0.1951
    0.9328   -0.3031   -0.1951
    0.8739   -0.4453   -0.1951
    0.7935   -0.5765   -0.1951
    0.6935   -0.6935   -0.1951
    0.5765   -0.7935   -0.1951
    0.4453   -0.8739   -0.1951
    0.3031   -0.9328   -0.1951
    0.1534   -0.9687   -0.1951
    0.1564    0.9877         0
    0.3090    0.9511         0
    0.4540    0.8910         0
    0.5878    0.8090         0
    0.7071    0.7071         0
    0.8090    0.5878         0
    0.8910    0.4540         0
    0.9511    0.3090         0
    0.9877    0.1564         0
    1.0000         0         0
    0.9877   -0.1564         0
    0.9511   -0.3090         0
    0.8910   -0.4540         0
    0.8090   -0.5878         0
    0.7071   -0.7071         0
    0.5878   -0.8090         0
    0.4540   -0.8910         0
    0.3090   -0.9511         0
    0.1564   -0.9877         0
   -0.9808         0    0.1951
   -0.9239         0    0.3827
   -0.8315         0    0.5556
   -0.7071         0    0.7071
   -0.5556         0    0.8315
   -0.3827         0    0.9239
   -0.1951         0    0.9808
    0.9808         0    0.1951
    0.9239         0    0.3827
    0.8315         0    0.5556
    0.7071         0    0.7071
    0.5556         0    0.8315
    0.3827         0    0.9239
    0.1951         0    0.9808
   -0.5489    0.6717    0.4975
    0.5489    0.6717    0.4975
   -0.5489   -0.6717    0.4975
    0.5489   -0.6717    0.4975
   -0.7256    0.6332    0.2692
    0.7256    0.6332    0.2692
   -0.7256   -0.6332    0.2692
    0.7256   -0.6332    0.2692
   -0.2956    0.6979    0.6524
    0.2956    0.6979    0.6524
   -0.2956   -0.6979    0.6524
    0.2956   -0.6979    0.6524
   -0.7796    0.6110    0.1376
    0.7796    0.6110    0.1376
   -0.7796   -0.6110    0.1376
    0.7796   -0.6110    0.1376
   -0.6481    0.6537    0.3907
    0.6481    0.6537    0.3907
   -0.6481   -0.6537    0.3907
    0.6481   -0.6537    0.3907
   -0.4299    0.6867    0.5862
    0.4299    0.6867    0.5862
   -0.4299   -0.6867    0.5862
    0.4299   -0.6867    0.5862
   -0.1505    0.7048    0.6933
    0.1505    0.7048    0.6933
   -0.1505   -0.7048    0.6933
    0.1505   -0.7048    0.6933
   -0.6647    0.3612    0.6540
    0.6647    0.3612    0.6540
   -0.6647   -0.3612    0.6540
    0.6647   -0.3612    0.6540
   -0.8720    0.3373    0.3547
    0.8720    0.3373    0.3547
   -0.8720   -0.3373    0.3547
    0.8720   -0.3373    0.3547
   -0.3589    0.3771    0.8538
    0.3589    0.3771    0.8538
   -0.3589   -0.3771    0.8538
    0.3589   -0.3771    0.8538
   -0.9288    0.3235    0.1811
    0.9288    0.3235    0.1811
   -0.9288   -0.3235    0.1811
    0.9288   -0.3235    0.1811
   -0.7829    0.3500    0.5143
    0.7829    0.3500    0.5143
   -0.7829   -0.3500    0.5143
    0.7829   -0.3500    0.5143
   -0.5215    0.3703    0.7687
    0.5215    0.3703    0.7687
   -0.5215   -0.3703    0.7687
    0.5215   -0.3703    0.7687
   -0.1829    0.3813    0.9062
    0.1829    0.3813    0.9062
   -0.1829   -0.3813    0.9062
    0.1829   -0.3813    0.9062
   -0.3822    0.8869    0.2595
    0.3822    0.8869    0.2595
   -0.3822   -0.8869    0.2595
    0.3822   -0.8869    0.2595
   -0.5080    0.8503    0.1376
    0.5080    0.8503    0.1376
   -0.5080   -0.8503    0.1376
    0.5080   -0.8503    0.1376
   -0.2063    0.9139    0.3495
    0.2063    0.9139    0.3495
   -0.2063   -0.9139    0.3495
    0.2063   -0.9139    0.3495
   -0.5534    0.8300    0.0698
    0.5534    0.8300    0.0698
   -0.5534   -0.8300    0.0698
    0.5534   -0.8300    0.0698
   -0.4509    0.8695    0.2016
    0.4509    0.8695    0.2016
   -0.4509   -0.8695    0.2016
    0.4509   -0.8695    0.2016
   -0.2994    0.9022    0.3105
    0.2994    0.9022    0.3105
   -0.2994   -0.9022    0.3105
    0.2994   -0.9022    0.3105
   -0.1052    0.9213    0.3742
    0.1052    0.9213    0.3742
   -0.1052   -0.9213    0.3742
    0.1052   -0.9213    0.3742
   -0.2866    0.9496    0.1273
    0.2866    0.9496    0.1273
   -0.2866   -0.9496    0.1273
    0.2866   -0.9496    0.1273
   -0.3827    0.9215    0.0663
    0.3827    0.9215    0.0663
   -0.3827   -0.9215    0.0663
    0.3827   -0.9215    0.0663
   -0.1554    0.9720    0.1761
    0.1554    0.9720    0.1761
   -0.1554   -0.9720    0.1761
    0.1554   -0.9720    0.1761
   -0.4706    0.7935    0.3859
    0.4706    0.7935    0.3859
   -0.4706   -0.7935    0.3859
    0.4706   -0.7935    0.3859
   -0.6239    0.7535    0.2073
    0.6239    0.7535    0.2073
   -0.6239   -0.7535    0.2073
    0.6239   -0.7535    0.2073
   -0.2535    0.8215    0.5108
    0.2535    0.8215    0.5108
   -0.2535   -0.8215    0.5108
    0.2535   -0.8215    0.5108
   -0.6744    0.7308    0.1057
    0.6744    0.7308    0.1057
   -0.6744   -0.7308    0.1057
    0.6744   -0.7308    0.1057
   -0.5556    0.7747    0.3019
    0.5556    0.7747    0.3019
   -0.5556   -0.7747    0.3019
    0.5556   -0.7747    0.3019
   -0.3684    0.8095    0.4572
    0.3684    0.8095    0.4572
   -0.3684   -0.8095    0.4572
    0.3684   -0.8095    0.4572
   -0.1291    0.8289    0.5442
    0.1291    0.8289    0.5442
   -0.1291   -0.8289    0.5442
    0.1291   -0.8289    0.5442
   -0.6146    0.5258    0.5881
    0.6146    0.5258    0.5881
   -0.6146   -0.5258    0.5881
    0.6146   -0.5258    0.5881
   -0.8094    0.4930    0.3190
    0.8094    0.4930    0.3190
   -0.8094   -0.4930    0.3190
    0.8094   -0.4930    0.3190
   -0.3313    0.5478    0.7682
    0.3313    0.5478    0.7682
   -0.3313   -0.5478    0.7682
    0.3313   -0.5478    0.7682
   -0.8653    0.4739    0.1630
    0.8653    0.4739    0.1630
   -0.8653   -0.4739    0.1630
    0.8653   -0.4739    0.1630
   -0.7249    0.5105    0.4625
    0.7249    0.5105    0.4625
   -0.7249   -0.5105    0.4625
    0.7249   -0.5105    0.4625
   -0.4817    0.5385    0.6914
    0.4817    0.5385    0.6914
   -0.4817   -0.5385    0.6914
    0.4817   -0.5385    0.6914
   -0.1687    0.5536    0.8155
    0.1687    0.5536    0.8155
   -0.1687   -0.5536    0.8155
    0.1687   -0.5536    0.8155
   -0.6963    0.1838    0.6938
    0.6963    0.1838    0.6938
   -0.6963   -0.1838    0.6938
    0.6963   -0.1838    0.6938
   -0.9108    0.1712    0.3757
    0.9108    0.1712    0.3757
   -0.9108   -0.1712    0.3757
    0.9108   -0.1712    0.3757
   -0.3766    0.1922    0.9062
    0.3766    0.1922    0.9062
   -0.3766   -0.1922    0.9062
    0.3766   -0.1922    0.9062
   -0.9677    0.1640    0.1916
    0.9677    0.1640    0.1916
   -0.9677   -0.1640    0.1916
    0.9677   -0.1640    0.1916
   -0.8191    0.1779    0.5453
    0.8191    0.1779    0.5453
   -0.8191   -0.1779    0.5453
    0.8191   -0.1779    0.5453
   -0.5469    0.1886    0.8157
    0.5469    0.1886    0.8157
   -0.5469   -0.1886    0.8157
    0.5469   -0.1886    0.8157
   -0.1920    0.1943    0.9620
    0.1920    0.1943    0.9620
   -0.1920   -0.1943    0.9620
    0.1920   -0.1943    0.9620
   -0.9239         0   -0.3827
    0.9239         0   -0.3827
   -0.9239         0   -0.3827
    0.9239         0   -0.3827
   -0.8787   -0.2855   -0.3827
    0.8787   -0.2855   -0.3827
    0.7501    0.5450   -0.3746
    0.6783    0.7273   -0.1045
    0.5507    0.8164    0.1736
    0.2777    0.8548    0.4384
    0.1545    0.7269    0.6691
         0    0.5299    0.8480
   -0.1620    0.2230    0.9613
    0.5450    0.7501   -0.3746
    0.4360    0.8939   -0.1045
    0.2879    0.9418    0.1736
         0    0.8988    0.4384
   -0.1545    0.7269    0.6691
   -0.3115    0.4287    0.8480
    0.2865    0.8818   -0.3746
    0.1556    0.9823   -0.1045
         0    0.9848    0.1736
         0    0.8315   -0.5556
   -0.1556    0.9823   -0.1045
   -0.3043    0.9366    0.1736
   -0.2777    0.8548    0.4384
   -0.4368    0.6012    0.6691
   -0.2865    0.8818   -0.3746
   -0.4360    0.8939   -0.1045
   -0.5789    0.7967    0.1736
   -0.5283    0.7271    0.4384
   -0.5450    0.7501   -0.3746
   -0.6783    0.7273   -0.1045
   -0.7760    0.6063    0.1736
   -0.7271    0.5283    0.4384
   -0.6436    0.3716    0.6691
   -0.5040    0.1638    0.8480
   -0.2621   -0.0852    0.9613
   -0.7501    0.5450   -0.3746
   -0.8613    0.4973   -0.1045
   -0.9194    0.3529    0.1736
   -0.8548    0.2777    0.4384
   -0.7391    0.0777    0.6691
   -0.5040   -0.1638    0.8480
   -0.8818    0.2865   -0.3746
   -0.9690    0.2237   -0.1045
   -0.9824    0.0687    0.1736
   -0.8988         0    0.4384
   -0.7068   -0.2296    0.6691
   -0.6824    0.3940   -0.6157
   -0.9272         0   -0.3746
   -0.9921   -0.0694   -0.1045
   -0.9596   -0.2215    0.1736
   -0.8548   -0.2777    0.4384
   -0.7760    0.1368   -0.6157
   -0.9285   -0.3564   -0.1045
   -0.8529   -0.4924    0.1736
   -0.7271   -0.5283    0.4384
   -0.5523   -0.4973    0.6691
   -0.3115   -0.4287    0.8480
         0   -0.2756    0.9613
   -0.7760   -0.1368   -0.6157
   -0.8535   -0.3623   -0.3746
   -0.7837   -0.6123   -0.1045
   -0.6716   -0.7202    0.1736
   -0.5283   -0.7271    0.4384
   -0.3023   -0.6789    0.6691
         0   -0.5299    0.8480
   -0.6824   -0.3940   -0.6157
   -0.6998   -0.6083   -0.3746
   -0.5704   -0.8147   -0.1045
   -0.4317   -0.8851    0.1736
   -0.2777   -0.8548    0.4384
         0   -0.7431    0.6691
   -0.5065   -0.6037   -0.6157
   -0.4913   -0.7863   -0.3746
   -0.3073   -0.9458   -0.1045
   -0.1541   -0.9727    0.1736
         0   -0.8988    0.4384
   -0.2695   -0.7405   -0.6157
   -0.1610   -0.9131   -0.3746
         0   -0.9945   -0.1045
    0.1541   -0.9727    0.1736
    0.2777   -0.8548    0.4384
    0.3023   -0.6789    0.6691
    0.3115   -0.4287    0.8480
    0.2621   -0.0852    0.9613
         0   -0.7880   -0.6157
    0.1610   -0.9131   -0.3746
    0.3073   -0.9458   -0.1045
    0.4317   -0.8851    0.1736
    0.5283   -0.7271    0.4384
    0.5523   -0.4973    0.6691
    0.5040   -0.1638    0.8480
    0.2695   -0.7405   -0.6157
    0.4775   -0.7948   -0.3746
    0.5704   -0.8147   -0.1045
    0.6716   -0.7202    0.1736
    0.7271   -0.5283    0.4384
    0.7068   -0.2296    0.6691
    0.5065   -0.6037   -0.6157
    0.6998   -0.6083   -0.3746
    0.7837   -0.6123   -0.1045
    0.8529   -0.4924    0.1736
    0.8548   -0.2777    0.4384
    0.6824   -0.3940   -0.6157
    0.8535   -0.3623   -0.3746
    0.9285   -0.3564   -0.1045
    0.9596   -0.2215    0.1736
    0.8988         0    0.4384
    0.7391    0.0777    0.6691
    0.5040    0.1638    0.8480
    0.1620    0.2230    0.9613
    0.7760   -0.1368   -0.6157
    0.9921   -0.0694   -0.1045
    0.9824    0.0687    0.1736
    0.8548    0.2777    0.4384
    0.6436    0.3716    0.6691
    0.3115    0.4287    0.8480
    0.7760    0.1368   -0.6157
    0.9272         0   -0.3746
    0.9690    0.2237   -0.1045
    0.9194    0.3529    0.1736
    0.7271    0.5283    0.4384
    0.4368    0.6012    0.6691
    0.6824    0.3940   -0.6157
    0.8818    0.2865   -0.3746
    0.8613    0.4973   -0.1045
    0.7760    0.6063    0.1736
    0.5283    0.7271    0.4384
    0.5065    0.6037   -0.6157
    0.2695    0.7405   -0.6157
   -0.2695    0.7405   -0.6157
   -0.5065    0.6037   -0.6157
         0         0    1.0000
];
     

% Long Lat
ElecCoords_sph = [
   90.0000  -33.7500
   90.0000  -22.5000
   90.0000  -11.2500
   90.0000         0
   90.0000   11.2500
   90.0000   22.5000
   90.0000   33.7500
   90.0000   45.0000
   90.0000   56.2500
   90.0000   67.5000
   90.0000   78.7500
         0   90.0000
  -90.0000   78.7500
  -90.0000   67.5000
  -90.0000   56.2500
  -90.0000   45.0000
  -90.0000   33.7500
  -90.0000   22.5000
  -90.0000   11.2500
  -90.0000         0
  -90.0000  -11.2500
  -90.0000  -22.5000
   99.0000  -22.5000
  108.0000  -22.5000
  117.0000  -22.5000
  126.0000  -22.5000
  135.0000  -22.5000
  144.0000  -22.5000
  153.0000  -22.5000
  162.0000  -22.5000
  171.0000  -22.5000
  180.0000  -22.5000
 -171.0000  -22.5000
 -162.0000  -22.5000
 -153.0000  -22.5000
 -144.0000  -22.5000
 -135.0000  -22.5000
 -126.0000  -22.5000
 -117.0000  -22.5000
 -108.0000  -22.5000
  -99.0000  -22.5000
   99.0000  -11.2500
  108.0000  -11.2500
  117.0000  -11.2500
  126.0000  -11.2500
  135.0000  -11.2500
  144.0000  -11.2500
  153.0000  -11.2500
  162.0000  -11.2500
  171.0000  -11.2500
  180.0000  -11.2500
 -171.0000  -11.2500
 -162.0000  -11.2500
 -153.0000  -11.2500
 -144.0000  -11.2500
 -135.0000  -11.2500
 -126.0000  -11.2500
 -117.0000  -11.2500
 -108.0000  -11.2500
  -99.0000  -11.2500
   99.0000         0
  108.0000         0
  117.0000         0
  126.0000         0
  135.0000         0
  144.0000         0
  153.0000         0
  162.0000         0
  171.0000         0
  180.0000         0
 -171.0000         0
 -162.0000         0
 -153.0000         0
 -144.0000         0
 -135.0000         0
 -126.0000         0
 -117.0000         0
 -108.0000         0
  -99.0000         0
   81.0000  -22.5000
   72.0000  -22.5000
   63.0000  -22.5000
   54.0000  -22.5000
   45.0000  -22.5000
   36.0000  -22.5000
   27.0000  -22.5000
   18.0000  -22.5000
    9.0000  -22.5000
         0  -22.5000
   -9.0000  -22.5000
  -18.0000  -22.5000
  -27.0000  -22.5000
  -36.0000  -22.5000
  -45.0000  -22.5000
  -54.0000  -22.5000
  -63.0000  -22.5000
  -72.0000  -22.5000
  -81.0000  -22.5000
   81.0000  -11.2500
   72.0000  -11.2500
   63.0000  -11.2500
   54.0000  -11.2500
   45.0000  -11.2500
   36.0000  -11.2500
   27.0000  -11.2500
   18.0000  -11.2500
    9.0000  -11.2500
         0  -11.2500
   -9.0000  -11.2500
  -18.0000  -11.2500
  -27.0000  -11.2500
  -36.0000  -11.2500
  -45.0000  -11.2500
  -54.0000  -11.2500
  -63.0000  -11.2500
  -72.0000  -11.2500
  -81.0000  -11.2500
   81.0000         0
   72.0000         0
   63.0000         0
   54.0000         0
   45.0000         0
   36.0000         0
   27.0000         0
   18.0000         0
    9.0000         0
         0         0
   -9.0000         0
  -18.0000         0
  -27.0000         0
  -36.0000         0
  -45.0000         0
  -54.0000         0
  -63.0000         0
  -72.0000         0
  -81.0000         0
  180.0000   11.2500
  180.0000   22.5000
  180.0000   33.7500
  180.0000   45.0000
  180.0000   56.2500
  180.0000   67.5000
  180.0000   78.7500
         0   11.2500
         0   22.5000
         0   33.7500
         0   45.0000
         0   56.2500
         0   67.5000
         0   78.7500
  129.2540   29.8330
   50.7460   29.8330
 -129.2540   29.8330
  -50.7460   29.8330
  138.8910   15.6190
   41.1090   15.6190
 -138.8910   15.6190
  -41.1090   15.6190
  112.9530   40.7220
   67.0470   40.7220
 -112.9530   40.7220
  -67.0470   40.7220
  141.9130    7.9070
   38.0870    7.9070
 -141.9130    7.9070
  -38.0870    7.9070
  134.7520   22.9980
   45.2480   22.9980
 -134.7520   22.9980
  -45.2480   22.9980
  122.0460   35.8890
   57.9540   35.8890
 -122.0460   35.8890
  -57.9540   35.8890
  102.0550   43.8900
   77.9450   43.8900
 -102.0550   43.8900
  -77.9450   43.8900
  151.4810   40.8470
   28.5190   40.8470
 -151.4810   40.8470
  -28.5190   40.8470
  158.8540   20.7730
   21.1460   20.7730
 -158.8540   20.7730
  -21.1460   20.7730
  133.5870   58.6270
   46.4130   58.6270
 -133.5870   58.6270
  -46.4130   58.6270
  160.7980   10.4330
   19.2020   10.4330
 -160.7980   10.4330
  -19.2020   10.4330
  155.9120   30.9520
   24.0880   30.9520
 -155.9120   30.9520
  -24.0880   30.9520
  144.6250   50.2350
   35.3750   50.2350
 -144.6250   50.2350
  -35.3750   50.2350
  115.6260   64.9840
   64.3740   64.9840
 -115.6260   64.9840
  -64.3740   64.9840
  113.3120   15.0400
   66.6880   15.0400
 -113.3120   15.0400
  -66.6880   15.0400
  120.8540    7.9080
   59.1460    7.9080
 -120.8540    7.9080
  -59.1460    7.9080
  102.7210   20.4580
   77.2790   20.4580
 -102.7210   20.4580
  -77.2790   20.4580
  123.6940    4.0050
   56.3060    4.0050
 -123.6940    4.0050
  -56.3060    4.0050
  117.4080   11.6300
   62.5920   11.6300
 -117.4080   11.6300
  -62.5920   11.6300
  108.3590   18.0870
   71.6410   18.0870
 -108.3590   18.0870
  -71.6410   18.0870
   96.5170   21.9770
   83.4830   21.9770
  -96.5170   21.9770
  -83.4830   21.9770
  106.7940    7.3110
   73.2060    7.3110
 -106.7940    7.3110
  -73.2060    7.3110
  112.5510    3.8000
   67.4490    3.8000
 -112.5510    3.8000
  -67.4490    3.8000
   99.0820   10.1410
   80.9180   10.1410
  -99.0820   10.1410
  -80.9180   10.1410
  120.6700   22.7000
   59.3300   22.7000
 -120.6700   22.7000
  -59.3300   22.7000
  129.6230   11.9660
   50.3770   11.9660
 -129.6230   11.9660
  -50.3770   11.9660
  107.1470   30.7200
   72.8530   30.7200
 -107.1470   30.7200
  -72.8530   30.7200
  132.7020    6.0680
   47.2980    6.0680
 -132.7020    6.0680
  -47.2980    6.0680
  125.6480   17.5730
   54.3520   17.5730
 -125.6480   17.5730
  -54.3520   17.5730
  114.4740   27.2070
   65.5260   27.2070
 -114.4740   27.2070
  -65.5260   27.2070
   98.8540   32.9730
   81.1460   32.9730
  -98.8540   32.9730
  -81.1460   32.9730
  139.4490   36.0190
   40.5510   36.0190
 -139.4490   36.0190
  -40.5510   36.0190
  148.6580   18.6050
   31.3420   18.6050
 -148.6580   18.6050
  -31.3420   18.6050
  121.1620   50.1920
   58.8380   50.1920
 -121.1620   50.1920
  -58.8380   50.1920
  151.2930    9.3830
   28.7070    9.3830
 -151.2930    9.3830
  -28.7070    9.3830
  144.8470   27.5470
   35.1530   27.5470
 -144.8470   27.5470
  -35.1530   27.5470
  131.8150   43.7410
   48.1850   43.7410
 -131.8150   43.7410
  -48.1850   43.7410
  106.9510   54.6360
   73.0490   54.6360
 -106.9510   54.6360
  -73.0490   54.6360
  165.2140   43.9350
   14.7860   43.9350
 -165.2140   43.9350
  -14.7860   43.9350
  169.3510   22.0700
   10.6490   22.0700
 -169.3510   22.0700
  -10.6490   22.0700
  152.9680   64.9900
   27.0320   64.9900
 -152.9680   64.9900
  -27.0320   64.9900
  170.3820   11.0480
    9.6180   11.0480
 -170.3820   11.0480
   -9.6180   11.0480
  167.7450   33.0450
   12.2550   33.0450
 -167.7450   33.0450
  -12.2550   33.0450
  160.9730   54.6570
   19.0270   54.6570
 -160.9730   54.6570
  -19.0270   54.6570
  134.6450   74.1470
   45.3550   74.1470
 -134.6450   74.1470
  -45.3550   74.1470
  180.0000  -22.5000
         0  -22.5000
  180.0000  -22.5000
         0  -22.5000
 -162.0000  -22.5000
  -18.0000  -22.5000
   36.0000  -22.0000
   47.0000   -6.0000
   56.0000   10.0000
   72.0000   26.0000
   78.0000   42.0000
   90.0000   58.0000
  126.0000   74.0000
   54.0000  -22.0000
   64.0000   -6.0000
   73.0000   10.0000
   90.0000   26.0000
  102.0000   42.0000
  126.0000   58.0000
   72.0000  -22.0000
   81.0000   -6.0000
   90.0000   10.0000
   90.0000  -33.7500
   99.0000   -6.0000
  108.0000   10.0000
  108.0000   26.0000
  126.0000   42.0000
  108.0000  -22.0000
  116.0000   -6.0000
  126.0000   10.0000
  126.0000   26.0000
  126.0000  -22.0000
  133.0000   -6.0000
  142.0000   10.0000
  144.0000   26.0000
  150.0000   42.0000
  162.0000   58.0000
 -162.0000   74.0000
  144.0000  -22.0000
  150.0000   -6.0000
  159.0000   10.0000
  162.0000   26.0000
  174.0000   42.0000
 -162.0000   58.0000
  162.0000  -22.0000
  167.0000   -6.0000
  176.0000   10.0000
  180.0000   26.0000
 -162.0000   42.0000
  150.0000  -38.0000
  180.0000  -22.0000
 -176.0000   -6.0000
 -167.0000   10.0000
 -162.0000   26.0000
  170.0000  -38.0000
 -159.0000   -6.0000
 -150.0000   10.0000
 -144.0000   26.0000
 -138.0000   42.0000
 -126.0000   58.0000
  -90.0000   74.0000
 -170.0000  -38.0000
 -157.0000  -22.0000
 -142.0000   -6.0000
 -133.0000   10.0000
 -126.0000   26.0000
 -114.0000   42.0000
  -90.0000   58.0000
 -150.0000  -38.0000
 -139.0000  -22.0000
 -125.0000   -6.0000
 -116.0000   10.0000
 -108.0000   26.0000
  -90.0000   42.0000
 -130.0000  -38.0000
 -122.0000  -22.0000
 -108.0000   -6.0000
  -99.0000   10.0000
  -90.0000   26.0000
 -110.0000  -38.0000
 -100.0000  -22.0000
  -90.0000   -6.0000
  -81.0000   10.0000
  -72.0000   26.0000
  -66.0000   42.0000
  -54.0000   58.0000
  -18.0000   74.0000
  -90.0000  -38.0000
  -80.0000  -22.0000
  -72.0000   -6.0000
  -64.0000   10.0000
  -54.0000   26.0000
  -42.0000   42.0000
  -18.0000   58.0000
  -70.0000  -38.0000
  -59.0000  -22.0000
  -55.0000   -6.0000
  -47.0000   10.0000
  -36.0000   26.0000
  -18.0000   42.0000
  -50.0000  -38.0000
  -41.0000  -22.0000
  -38.0000   -6.0000
  -30.0000   10.0000
  -18.0000   26.0000
  -30.0000  -38.0000
  -23.0000  -22.0000
  -21.0000   -6.0000
  -13.0000   10.0000
         0   26.0000
    6.0000   42.0000
   18.0000   58.0000
   54.0000   74.0000
  -10.0000  -38.0000
   -4.0000   -6.0000
    4.0000   10.0000
   18.0000   26.0000
   30.0000   42.0000
   54.0000   58.0000
   10.0000  -38.0000
         0  -22.0000
   13.0000   -6.0000
   21.0000   10.0000
   36.0000   26.0000
   54.0000   42.0000
   30.0000  -38.0000
   18.0000  -22.0000
   30.0000   -6.0000
   38.0000   10.0000
   54.0000   26.0000
   50.0000  -38.0000
   70.0000  -38.0000
  110.0000  -38.0000
  130.0000  -38.0000
         0   90.0000
];

